<form method="post"
      name="accountForm"
      ng-submit="_pcustomer_register_or_save(customer)"
      class="slide-top">
	
<ion-card inset="true" lines="none" class="register-form">
    <section class="avatar text-center padding"
             ng-if="show_avatar">
        <div>
            <img width="150"
                 height="150"
                 ng-src="{{ avatar_url }}"
                 src="data:image/jpeg;base64,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"
                 class="padding stable-bg stable-border avatar"
                 ng-click="editAvatar()"
                 sb-load="avatarLoaded()"
                 sb-error="hideAvatar()" />
        </div>
    </section>

	<label class="item item-input item-floating-label">
		<span class="input-label">{{ "Firstname" | translate }}</span>
		<input type="text" placeholder='{{ "Firstname" | translate }}' ng-model="customer.firstname">
	</label>
	<label class="item item-input item-floating-label">
		<span class="input-label">{{ "Lastname" | translate }}</span>
		<input type="text" placeholder='{{ "Lastname" | translate }}' ng-model="customer.lastname">
	</label>	
	<label class="item item-input item-floating-label" ng-if="optional_fields.nickname">
		<span class="input-label">{{ "Nickname" | translate }}</span>
		<input type="text" placeholder='{{ "Nickname" | translate }}' ng-model="customer.nickname">
	</label>
	<label class="item item-input item-floating-label">
		<span class="input-label">{{ 'Email' | translate }}</span>
		<input type="email" placeholder="{{ 'Email' | translate }}" ng-model="customer.email">
	</label>
	<ion-button type="button" fill="outline" ng-if="is_logged_in" ng-click="customer.change_password = !customer.change_password" expand="block" color="primary">{{ 'Change Password' | translate }}</ion-button>	
	
	<label class="item item-input item-floating-label" ng-if="customer.change_password && is_logged_in">
		<span ng-if="is_logged_in" class="input-label">{{ "Old Password" | translate }}</span>
		<input ng-if="is_logged_in" type="password" placeholder='{{ "Old Password" | translate }}' ng-model="customer.old_password" ng-disabled="!customer.change_password">
	</label>

	<label class="item item-input item-floating-label" ng-if="customer.change_password || !is_logged_in">
		<span class="input-label">{{ 'Password' | translate }}</span>
		<input type="password" placeholder="{{ 'Password' | translate }}" ng-model="customer.password" ng-disabled="!customer.change_password && is_logged_in">
	</label>
	
  <ion-item ng-if="optional_fields.ranking">
    <ion-label style="width: 100%; text-align: center; max-width:1000px;">{{ "Show me in ranking" | translate }}</ion-label>
    <ion-checkbox slot="start" ng-model="customer.show_in_social_gaming" color="primary"></ion-checkbox>
  </ion-item>
  
  <ion-item ng-if="!is_logged_in">
		<ion-label style="padding:0px!important;margin:0px!important;font-size:11px;" ng-click="displayPrivacyPolicy('account')">{{ "Privacy Policy" | translate }}</ion-label>
		<ion-checkbox color="primary" ng-model="customer.privacy_policy" checked slot="start"></ion-checkbox>
  </ion-item>  
  
	<section ng-repeat="cfo in custom_fields track by cf.code">
		<ion-list-header>
			<ion-label>{{ cfo.name }}:</ion-label>
		</ion-list-header>
		<label class="item item-input item-floating-label" ng-repeat="cf in cfo.custom_fields">
			<span class="input-label">{{ cf.label | translate }}</span>
			<input type="{{cf.type}}" ng-model="customer.metadatas[cfo.code][cf.key]">
		</label>		

	</section>
 
        <!-- Version #2 of the custom login fields -->
        <section ng-repeat="fields in customer.extendedFields track by $index">
            <div ng-class="{'card': card_design}"
                 ng-repeat="field in fields track by field.key"
                 ng-include="'templates/customer/account/l1/fields/' + field.type + '.html'"></div>
        </section> 
 
 	
 	
	<ion-button expand="block" fill="clear" size="small" ng-click="requestToken();" color="medium" ng-if="is_logged_in && gdpr.isEnabled"><ion-icon slot="start" name="download"></ion-icon> {{ "Access my personal data" | translate }}</ion-button>

	<ion-button expand="block" type="submit" color="primary" color="secondary"><ion-icon slot="start" name="person-add"></ion-icon> {{ "Send" | translate }}</ion-button>
	
	<ion-item ng-if="customer.metadatas.fidelity_points" ng-show="customer.metadatas.fidelity_points.points > 0">
		<ion-icon name="information-circle-outline"></ion-icon> {{ "Your points" | translate }} {{ customer.metadatas.fidelity_points.points }}
	</ion-item>
	
	<ion-list-header ng-if="show_avatar" ng-show="customer.stripe">
		<ion-label>{{ "Stored card information." | translate }}</ion-label>
	</ion-list-header>	
	<ion-item ng-if="show_avatar" ng-show="customer.stripe.brand">
		<ion-icon name="card"></ion-icon> {{ "XXXX XXXX XXXX" }} {{ customer.stripe.last4 }}
	</ion-item>
	<ion-item ng-if="show_avatar" ng-show="customer.stripe.brand">
		{{ "CVC ***" }} - {{ "EXP" }} {{ customer.stripe.exp_month }}/{{ customer.stripe.exp_year }}
	</ion-item>
	<ion-button expand="block" fill="outline" ng-click="unloadcard()" color="primary" ng-show="customer.stripe.brand"><ion-icon slot="start" name="trash"></ion-icon> {{ "Remove card" | translate }}</ion-button>
	<ion-item ng-if="!customer.stripe.brand" ng-show="customer.stripe.brand">
		{{ "You have no card stored. To add a card make an order." | translate }}
	</ion-item>	
	<ion-button ng-if="is_logged_in" expand="block" fill="clear" size="small" ng-click="displayPrivacyPolicy('account')" color="medium"><ion-icon slot="start" name="open"></ion-icon> {{ "Privacy Policy" | translate }}</ion-button>
</ion-card>
</form>
<style>
	.avatar {
		border-radius: 100%;
		width: 150px !important;
		position: relative;
		left: 50%;
		margin-left: -75px !important;
	}
</style>